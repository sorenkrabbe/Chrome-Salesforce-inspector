<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Data Export</title>
  <link rel="stylesheet" href="chromePopup.css">
  <link rel="stylesheet" href="dataLoad.css">
  <link rel="stylesheet" href="dataExport.css">
</head>
<body>
  <img id="spinner" src="data:image/gif;base64,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" data-bind="visible: spinnerCount() > 0">
  <div id="user-info" data-bind="text: userInfo"></div>
  <div class="area">
    <h1>Export query</h1>
    <label><input type="checkbox" data-bind="checked: queryAll, disable: queryTooling"> <span>Include deleted and archived records?</span></label>
    <label title="With the tooling API you can query more metadata, but you cannot query regular data"><input type="checkbox" data-bind="checked: queryTooling, disable: queryAll"> <span>Use Tooling API?</span></label>
    <label>
      <select data-bind="options: queryHistory, optionsCaption: 'Query history', optionsText: function(q) { return q.substring(0, 300); }, value: selectedHistoryEntry, event: {change: selectHistoryEntry}" class="query-history"></select>
      <a href="about:blank" data-bind="click: clearHistory" title="Clear query history" class="char-btn">X</a>
    </label>
    <a href="about:blank" id="export-help-btn" data-bind="click: toggleHelp">Export help</a>
    <textarea id="query" data-bind="style: {maxHeight: (winInnerHeight() - 200) + 'px'}"></textarea>
    <div class="autocomplete-box" data-bind="css: {expanded: expandAutocomplete}">
      <span class="autocomplete-results">
        <span data-bind="text: autocompleteResults().title"></span>
        <span data-bind="foreach: autocompleteResults().results">
          <a data-bind="text: value, attr: {title: title}, click: $parent.autocompleteClick" href="about:blank"></a>
        </span>
      </span>
      <a href="about:blank" class="char-btn" data-bind="click: showDescribe, visible: autocompleteResults().sobjectName, attr: {title: 'Show field info for the ' + autocompleteResults().sobjectName + ' object'}">i</a>
      <a href="about:blank" class="char-btn" data-bind="click: toggleExpand, text: expandAutocomplete() ? '-' : '+'" title="Show all suggestions or only the first line"></a>
    </div>
    <div data-bind="visible: showHelp">
      <p>Use for quick one-off data exports. Enter a <a href="http://www.salesforce.com/us/developer/docs/soql_sosl/" target="_blank">SOQL query</a> in the box above and press Export (or press Ctrl+Enter)</p>
      <p>Press Ctrl+Space to insert all field name autosuggestions or to load suggestions for field values.</p>
      <p>Supports the full SOQL language. The columns in the CSV output depend on the returned data. Using subqueries may cause the output to grow rapidly. Bulk API is not supported. Large data volumes may freeze or crash your browser.</p>
    </div>
  </div>
  <div class="action-arrow">
    <div class="arrow-body"><button data-bind="disable: exportResult().isWorking, click: doExport">Export</button></div>
    <div class="arrow-head"></div>
  </div>
  <div class="area" id="result-area">
    <h1>Export result</h1>
    <button data-bind="enable: canCopy(), click: copyAsExcel" title="Copy exported data to clipboard for pasting into Excel or similar">Copy Excel</button>
    <button data-bind="enable: canCopy(), click: copyAsCsv" title="Copy exported data to clipboard for saving as a CSV file">Copy CSV</button>
    <button data-bind="enable: canCopy(), click: copyAsJson" title="Copy raw API output to clipboard">Copy JSON</button>
    <input placeholder="Filter results" data-bind="value: resultsFilter, valueUpdate: 'input'">
    <span class="result-status">
      <span data-bind="text: exportResult().exportStatus"></span>
      <button class="cancel-btn" data-bind="enable: exportResult().isWorking, click: stopExport">Stop</button>
    </span>
    <div id="result-box" data-bind="style: {height: (winInnerHeight() - resultBoxOffsetTop() - 25) + 'px'}">
      <textarea id="result-text" readonly data-bind="text: exportResult().exportError, visible: exportResult().exportError != null"></textarea>
      <div id="result-table">
        <!-- the scroll table goes here -->
      </div>
    </div>
  </div>
  <script src="knockout-3.2.0.js"></script>
  <script src="inspector.js"></script>
  <script src="chromePopup.js"></script>
  <script src="dataLoad.js"></script>
  <script src="dataExport.js"></script>
  <script src="utils/mousetrap.js"></script>
</body>
</html>
